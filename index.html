<head>
    <META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=UTF-8">
<!-- For CAPTCHA -->
<!-- <script src="https://www.google.com/recaptcha/api.js"></script>
<script>
function timestamp()
{ 
    var response = document.getElementById("g-recaptcha-response"); 
    if (response == null || response.value.trim() == "") 
    {
    var elems = JSON.parse(document.getElementsByName("captcha_settings")[0].value);elems["ts"] = JSON.stringify(new Date().getTime());document.getElementsByName("captcha_settings")[0].value = JSON.stringify(elems); 
    } 
    
} setInterval(timestamp, 500); 
</script> -->
      
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 160vh;
        margin: 0;
      }
  
      form, .confirmation-container {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        width: 940px;
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
      }
  
      .box {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
      }
  
      .form-group {
        display: flex;
        flex-direction: column;
        width: 100%;
      }
  
      .form-group.left,
      .form-group.right {
        width: 48%;
      }
  
      label {
        margin-bottom: 5px;
      }
  
      select,
      input,
      textarea,
      option {
        padding: 8px;
        margin-bottom: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
      }
  
      input[type="submit"] {
        display: block;
        width: 100px;
        padding: 10px;
        margin: 10 px auto 0 auto;
        background-color: #28a745;
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
  
      .header {
        width: 100%;
        margin-bottom: 5px;
      }
  
      .header h2,
      h3 {
        color: lightblue;
        margin: 0;
        font-size: 30px;
      }
  
      .header p,
      p1 {
        font-style: italic;
        margin: 5px 0 0 0;
        color: #000;
      }
  
      .box-footer {
        width: 100%;
        margin-top: 10px;
        text-align: center;
        font-style: italic;
        color: #000;
      }
      
    </style>
  </head>
  <body>
    <form action="https://aaa-ace--cts.sandbox.my.salesforce.com/servlet/servlet.WebToCase?encoding=UTF-8&orgId=00DDc0000009Bqp" method="POST" id="formBox">


      <input type=hidden name="orgid" value="00DDc0000009Bqp">
      <input type=hidden name="retURL" value="https://saimq.github.io/dev/">
<!-- <input type=hidden name='captcha_settings' value='{"keyname":"ClubHubWebForm","fallback":"true","orgId":"00DDc0000009Bqp","ts":""}'> -->
      
      <!-- <input type="hidden" name="debug" value=1>
      <input type="hidden" name="debugEmail" value="qazi.saim@ace.aaa.com"> -->
   
      <input type=hidden name="status" id="status" value="New">
      <input type=hidden name="recordType" id="recordType" value="012Dc000000Z9pM">
      <input type="hidden" name="00N2R000007U8Y8" id="formattedDate" value=""/>
<!--Member Info Form-->
      <div class="header">
        <h2>Member Information</h2>
        <p>Please fill out all fields in this section</p>
      </div>
      <div class="form-group left">
        <label for="SuppliedName">Name</label>
        <input id="SuppliedName" name="first_name" maxlength="40" name="phone" size="20" type="text" required />
        <label for="phone">Contact Number</label>
        <input id="phone" maxlength="10" name="phone" size="20" type="text" pattern="\d{10}"/>
        If you wish to be contacted by Phone, please select a time<select  id="00NDc000003TgK3" name="00NDc000003TgK3" title="Time">
        <option value="">--None--</option><option value="10:00am CST">10:00am CST</option>
        <option value="12:00pm CST">12:00pm CST</option>
        <option value="2:00pm CST">2:00pm CST</option>
        <option value="4:00pm CST">4:00pm CST</option>
        </select><br>
        Service Date if applicable:<span class="dateInput dateOnlyInput">
        <input  id="date" name="" size="12" type="date"/></span><br>
      </div>
      <div class="form-group right"> Membership Number: <input id="membershipNumber" maxlength="16" minlength="16" pattern="\d{16}" name="00NDc000003Te8A" name="phone" size="20" type="text" title="Please enter your 16 digit Membership Number" required/>
        <label for="email">Email Address</label>
        <input id="email" maxlength="80" name="email" size="20" type="email" required/>
        <label for="type">What does this communication concern?</label>
        <select id="type" name="type" title="Type" required>
          <option value="">--None--</option>
          <option value="Complaint">Complaint</option>
          <option value="Compliment">Compliment</option>
          <option value="Membership Issue">Membership Issue</option>
          <option value="Service Verification">Service Verification</option>
        </select>
      </div>
<!--Compliment Box-->
      <div class="box" id="Compliment">
        <div class="header">
          <h3>Compliment</h3>
          <p1>If you selected Compliment above, please answer these questions:</p1>
        </div>
        <div class="form-group left"> 
        Who is the compliment for? <select id="Compliment Category" name="00NDc000003Te8a" title="Event Category">
          </select>
          <br>
        </div>
        <div class="form-group right">
          <label for="description">Please enter the name of the person or company if known?</label>
          <textarea id="description" name="description" rows="1"></textarea>
        </div>
      </div>
<!--Complaint Box-->
      <div class="box" id="Complaint">
        <div class="header">
          <h3>Complaint</h3>
          <p1>If you selected Complaint above, please answer these questions:</p1>
        </div>
        <div class="form-group left">
          <label for="00NDc000003Te8a"></label> What is the complaint concerning? <select id="Complaint Category" name="00NDc000003Te8a" title="Event Category" onChange="filterOptions('Complaint Category', 'Complaint Subcategory', webCatSubCatOptions, 'Complaint')">
          </select>
          <br>
        </div>
        <div class="form-group right">
          <label for="type">What is the reason?</label><select  id="Complaint Subcategory" name="00NDc000003Te8b">
          </select><br>
        </div>
      </div>
<!--Membership Issue Box-->
      <div class="box" id="Membership Issue">
        <div class="header">
          <h3>Membership Issue</h3>
          <p1>If you selected Membership/Payment issues above, please answer these questions:</p1>
        </div>
        <div class="form-group left">
          What is the complaint concerning? <select id="Membership Issue Category" name="00NDc000003Te8a" title="Event Category" onChange="filterOptions('Membership Issue Category', 'Membership Issue Subcategory', webCatSubCatOptions, 'Membership Issue')">
            </select>
            <br>
        </div>
        <div class="form-group right"> 
          <label for="type">What is the reason?</label><select  id="Membership Issue Subcategory" name="00NDc000003Te8b" >
          </select><br>
        </div>
      </div>
<!--Service Verification Box-->
      <div class="box" id="Service Verification">
        <div class="header" style="width: 700px;">
          <h3>Service Verification</h3>
          <p1>If you selected Membership/Payment issues above, please answer these questions:</p1>
        </div>
        <div class="form-group left">
          What is the complaint concerning? <select id="Service Verification Category" name="00NDc000003Te8a" title="Event Category" onChange="filterOptions('Service Verification Category', 'Service Verification Subcategory', webCatSubCatOptions, 'Service Verification')">
            </select>
            <br>
        </div>
        <div class="form-group right">
          <label for="type">What is the reason?</label><select  id="Service Verification Subcategory" name="00NDc000003Te8b">
          </select><br>
        </div>
      </div>
<!--Comments Box-->
      <div class="box">
        <div class="header" style="width: 700px;">
          <h3>Comments</h3>
          <p1>Please add details pertaining to your feedback here</p1>
        </div>
        <div class="form-group left">
          <label for="description"></label>
          <textarea name="description" rows="3"></textarea>
          <br>
          <!-- <div class="g-recaptcha" data-sitekey="6LfOAQYqAAAAALf8xrY9enbGUM0LqV10SW5XkyeG"></div><br> -->
          <input type="submit" name="submitButton" value="Submit" id="submitButton">
        </div>
        <div class="form-group right"></div>
      </div>
    </form>

    <div class="confirmation-container" id="confirmation-container" style="display: none;">
      <h2>Thank you!</h2>
      <p id="countdown">This page will refresh in <span id="timer">5</span> seconds</p>
    </div>

    <script>

    const redundantCategories = ['Membership Issue', 'Service Verification'];
    const webTypeCatOptions = {
      'Complaint': ['AAR/CCC', 'Battery', 'Call Center Agent', 'Damage', 'Facility', 'System Issue'],
      'Membership Issue': ['Membership Issue'],
      'Compliment': ['AAA Employee', 'Driver', 'Approved Auto Repair Shop'],
      'Service Verification': ['Service Verification'],
    };
    const webCatSubCatOptions = {
        'AAR/CCC': [
            'Apperance of the shop, cleanliness',
            'Communication with the shop',
            'Damage to my vehicle',
            'Poor Customer Service or Inappropriate behavior',
            'Poor Workmanship',
            'Cost was too high or it cost more than quoted',
            'Agent quoted me a different price',
            'Shop was Unable to repair my vehicle',
            'Agent provided a shop that can\'t repair my vehicle',
            'Shop made repairs I didn’t authorize',
            'Shop made repairs that were unnecessary'
        ],
        'Battery': [
            'Battery cost or unexpected fees',
            'Issue with the AAA Battery Warranty',
            'A battery was not available',
            'Battery jumpstart didn\'t work or or incorrect test results',
            'Installation or jumpstart caused damage to my vehicle'
         ],
           
        'Call Center Agent': [
            'Agent provided incorrect information',
            'My service request was not handled properly',
            'Etiquette'
        ],
        'Damage': [
            'My property was damaged',
            'My vehicle was damaged'
        ],
        'Facility': [
            'Service was delayed',
            'Driver Etiquette',
            'Missing Items',
            'Fees/Charges',
            'Accident Assist'
        ],
        'System Issue': [
            'Phone system',
            'Wait Time',
            'AAA Website or App'
        ],
        'Membership Issue': [
            'Payments',
            'Fees',
            'My call count'
        ],
        'Service Verification': [
            'Court',
            'Work',
            'Dispute'
        ],
      };
      

    document.getElementById("date").addEventListener("change", function(){
      var inputtedDate = this.value;
      if(inputtedDate){
        var correctDate = formatDate(inputtedDate);
        document.getElementById("formattedDate").value = correctDate;
      }
    });
        
    function formatDate(date){
      var [year, month, day] = date.split('-');
      return [parseInt(month), parseInt(day), year].join('/');
    }
 
    function removeSubCatOptions() {
      const detailSelect = document.getElementById(getPicklistValue('type') + ' Subcategory');
      if(detailSelect){
        const options = detailSelect.querySelectorAll('option');
        if (options && options.length > 0) {
          options.forEach((option) => {
            option.remove();
          });
        }
      }
    }
 
    function removeCatOptions() {
        const detailSelect = document.getElementById(getPicklistValue('type'));
        if(detailSelect){
          const options = detailSelect.querySelectorAll('option');
          if (options && options.length > 0) {
            options.forEach((option) => {
              option.remove();
            });
          }
        }
      }
 
    function createNoneOption() {
      const option = document.createElement('option');
      option.textContent = '--None--';
      option.value = '';
      return option;
    }
 
    var previousOption = '';
    function filterOptions(controlling, dependent, dependencies, selectedType) {
      removeSubCatOptions();
      const leadSourceSelect = document.getElementById(controlling);
      const leadSourceSelectOptions = leadSourceSelect.options;
      const selectedOption = leadSourceSelectOptions[leadSourceSelect.selectedIndex];
  
      if (selectedOption && selectedOption.value && dependencies[selectedOption.value]) {
        let options = dependencies[selectedOption.value].map((opt) => {
          const el = document.createElement('option');
          el.textContent = opt;
          el.value = opt;
          return el;
        });
  
        options = [createNoneOption()].concat(options);
        const leadSourceDetailSelect = document.getElementById(dependent);
        leadSourceDetailSelect.setAttribute("required", "");
        removeRequired(selectedType);
        options.forEach((opt) => {
          leadSourceDetailSelect.appendChild(opt);
        });
      }
      previousOption = selectedType;
    }

    function removeRequired(currentOption){
      if((previousOption !== '') && (previousOption !== currentOption) && currentOption != undefined){
        var subEventPicklist = document.getElementById(previousOption + ' Category');
        subEventPicklist.removeAttribute("required");
        subEventPicklist.value = '';

          if(previousOption !== 'Compliment'){
            var subcat = document.getElementById(previousOption + ' Subcategory');
            subcat.removeAttribute("required");
            subcat.value = '';
          }
      }
    }


    function showInputSections(){
      document.getElementById('Compliment').style.display = 'none';
      document.getElementById('Complaint').style.display = 'none';
      document.getElementById('Membership Issue').style.display = 'none';
      document.getElementById('Service Verification').style.display = 'none';
 
      var e = document.getElementById('type');
      if(e){
        document.getElementById(e.options[e.selectedIndex].text).style.display = 'flex';
      }
    }
 
    document.getElementById('type').addEventListener('change', () => {
      removeCatOptions();
      removeSubCatOptions();
      filterOptions('type', getPicklistValue('type') + ' Category', webTypeCatOptions, getPicklistValue('type'));
      showInputSections();
      setRedundantCategories();
    })
 
    showInputSections();
 
    function getPicklistValue (htmlId){
      var e = document.getElementById(htmlId);
      return e.options[e.selectedIndex].text;
    }
 
    function setRedundantCategories() {
      type =  getPicklistValue('type');
      if(redundantCategories.includes(type)){
        let element = document.getElementById(getPicklistValue('type') + ' Category');
        element.value = type;
        filterOptions(type + ' Category', type + ' Subcategory', webCatSubCatOptions, getPicklistValue('type'));        
      }
  }
  

</script>


  </body>
